import { postgraphile } from 'postgraphile';
import express from 'express';
import cors from 'cors';
const app = express();

app.use(
    cors({
        origin: 'http://localhost:5173', // Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ Ð´Ð¾Ð¼ÐµÐ½ Ð²Ð°ÑˆÐµÐ³Ð¾ Ñ„Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´Ð°
        credentials: true, // Ð Ð°Ð·Ñ€ÐµÑˆÐ¸Ñ‚ÑŒ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÑƒ cookies
    })
);

app.use(
    postgraphile(
        'postgres://postgres:1851@localhost:5432/flowerShop', // ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ðº Ð±Ð°Ð·Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ…
        'public', // Ð¡Ñ…ÐµÐ¼Ð° Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…
        {
            watchPg: true, // ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑ…ÐµÐ¼Ñ‹ Ð¿Ñ€Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¸ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…
            graphiql: true, // Ð’ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ GraphiQL Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
            enhanceGraphiql: true, // Ð£Ð»ÑƒÑ‡ÑˆÐµÐ½Ð½Ñ‹Ð¹ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ GraphiQL
        }
    )
);

app.listen(4000, () => {
    console.log('ðŸš€ Server ready at http://localhost:4000/graphql');
});